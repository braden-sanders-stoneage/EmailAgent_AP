[2025-10-13 14:33:11] Graph API GET users/ap-sausa@stoneagetools.com/mailFolders/inbox/messages failed
[2025-10-13 14:33:11]   Exception Type: ConnectionError
[2025-10-13 14:33:11]   Exception Message: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Max retries exceeded with url: /v1.0/users/ap-sausa@stoneagetools.com/mailFolders/inbox/messages?%24select=id%2Csubject%2Csender%2Cfrom%2CtoRecipients%2CreceivedDateTime%2CcreatedDateTime%2Cbody%2CbodyPreview%2CisRead%2Cimportance%2ChasAttachments%2CinternetMessageId%2CconversationId&%24orderby=receivedDateTime+desc&%24top=10 (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x00000200E9690CB0>: Failed to resolve 'graph.microsoft.com' ([Errno 11004] getaddrinfo failed)"))
[2025-10-13 14:33:11]   Stack Trace:
[2025-10-13 14:33:11]     Traceback (most recent call last):
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
[2025-10-13 14:33:11]         sock = connection.create_connection(
[2025-10-13 14:33:11]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\util\connection.py", line 60, in create_connection
[2025-10-13 14:33:11]         for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
[2025-10-13 14:33:11]                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 978, in getaddrinfo
[2025-10-13 14:33:11]         for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
[2025-10-13 14:33:11]                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]     socket.gaierror: [Errno 11004] getaddrinfo failed
[2025-10-13 14:33:11]     
[2025-10-13 14:33:11]     The above exception was the direct cause of the following exception:
[2025-10-13 14:33:11]     
[2025-10-13 14:33:11]     Traceback (most recent call last):
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
[2025-10-13 14:33:11]         response = self._make_request(
[2025-10-13 14:33:11]                    ^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
[2025-10-13 14:33:11]         raise new_e
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
[2025-10-13 14:33:11]         self._validate_conn(conn)
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
[2025-10-13 14:33:11]         conn.connect()
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connection.py", line 753, in connect
[2025-10-13 14:33:11]         self.sock = sock = self._new_conn()
[2025-10-13 14:33:11]                            ^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connection.py", line 205, in _new_conn
[2025-10-13 14:33:11]         raise NameResolutionError(self.host, self, e) from e
[2025-10-13 14:33:11]     urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x00000200E9690CB0>: Failed to resolve 'graph.microsoft.com' ([Errno 11004] getaddrinfo failed)
[2025-10-13 14:33:11]     
[2025-10-13 14:33:11]     The above exception was the direct cause of the following exception:
[2025-10-13 14:33:11]     
[2025-10-13 14:33:11]     Traceback (most recent call last):
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\adapters.py", line 644, in send
[2025-10-13 14:33:11]         resp = conn.urlopen(
[2025-10-13 14:33:11]                ^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
[2025-10-13 14:33:11]         retries = retries.increment(
[2025-10-13 14:33:11]                   ^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
[2025-10-13 14:33:11]         raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
[2025-10-13 14:33:11]         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]     urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Max retries exceeded with url: /v1.0/users/ap-sausa@stoneagetools.com/mailFolders/inbox/messages?%24select=id%2Csubject%2Csender%2Cfrom%2CtoRecipients%2CreceivedDateTime%2CcreatedDateTime%2Cbody%2CbodyPreview%2CisRead%2Cimportance%2ChasAttachments%2CinternetMessageId%2CconversationId&%24orderby=receivedDateTime+desc&%24top=10 (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x00000200E9690CB0>: Failed to resolve 'graph.microsoft.com' ([Errno 11004] getaddrinfo failed)"))
[2025-10-13 14:33:11]     
[2025-10-13 14:33:11]     During handling of the above exception, another exception occurred:
[2025-10-13 14:33:11]     
[2025-10-13 14:33:11]     Traceback (most recent call last):
[2025-10-13 14:33:11]       File "c:\Users\braden.sanders\Python\AI\AAAAA Email Agents\EmailAgent_AP\core\integrations\outlook\client.py", line 104, in graph_api_request
[2025-10-13 14:33:11]         response = requests.get(url, headers=headers, params=params, timeout=30)
[2025-10-13 14:33:11]                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\api.py", line 73, in get
[2025-10-13 14:33:11]         return request("get", url, params=params, **kwargs)
[2025-10-13 14:33:11]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\api.py", line 59, in request
[2025-10-13 14:33:11]         return session.request(method=method, url=url, **kwargs)
[2025-10-13 14:33:11]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\sessions.py", line 589, in request
[2025-10-13 14:33:11]         resp = self.send(prep, **send_kwargs)
[2025-10-13 14:33:11]                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\sessions.py", line 703, in send
[2025-10-13 14:33:11]         r = adapter.send(request, **kwargs)
[2025-10-13 14:33:11]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-13 14:33:11]       File "C:\Users\braden.sanders\AppData\Local\Programs\Python\Python312\Lib\site-packages\requests\adapters.py", line 677, in send
[2025-10-13 14:33:11]         raise ConnectionError(e, request=request)
[2025-10-13 14:33:11]     requests.exceptions.ConnectionError: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Max retries exceeded with url: /v1.0/users/ap-sausa@stoneagetools.com/mailFolders/inbox/messages?%24select=id%2Csubject%2Csender%2Cfrom%2CtoRecipients%2CreceivedDateTime%2CcreatedDateTime%2Cbody%2CbodyPreview%2CisRead%2Cimportance%2ChasAttachments%2CinternetMessageId%2CconversationId&%24orderby=receivedDateTime+desc&%24top=10 (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x00000200E9690CB0>: Failed to resolve 'graph.microsoft.com' ([Errno 11004] getaddrinfo failed)"))
